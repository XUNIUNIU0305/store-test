webpackJsonp([0],[function(t,e,a){"use strict";function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.url=t,e=Object.assign({method:"GET"},e),e=r(e),new Promise(function(t,a){var n=new XMLHttpRequest;n.open(e.method,e.url),n.addEventListener("load",function(e){var a=JSON.parse(n.response);200===a.status?t(a.data):o(a.data.errMsg)}),n.addEventListener("error",function(t){var a=t.target;o(a.statusText+"::"+a.status+"::"+e.url+"::"+a.readyState)}),n.send(e.body)})}function o(t){alert(t)}function r(t){if(void 0!==t.data){var e=t.data,a=new FormData;for(var n in e)a.append(n,e[n]);t.body=a,delete t.data}if(void 0!==t.params){var o=t.params,r="";for(var i in o)r+=i+"="+o[i]+"&";t.url+="?"+r.slice(0,-1),delete t.params}return t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=a(2),r=n(o),i=a(3),s=n(i),l=a(4),d=n(l),u=a(5),f=n(u),c=a(6),p=n(c),m=a(7),h=n(m),g=a(8),v=n(g),y=a(9),b=n(y),_=a(10),x=n(_),E=a(11),L=n(E),A=a(12),B=n(A),M=a(13),I=n(M),q=a(14),S=n(q),k=a(15),O=n(k),T=a(16),N=n(T);e.default={1:{arm:r.default,before:s.default,after:d.default},2:{arm:f.default,before:p.default,after:h.default},3:{arm:v.default,before:b.default,after:x.default},4:{arm:L.default,before:B.default,after:I.default},5:{arm:S.default,before:O.default,after:N.default}}},function(t,e,a){t.exports=a.p+"images/lottery/tool_1.png"},function(t,e,a){t.exports=a.p+"images/lottery/man1.png"},function(t,e,a){t.exports=a.p+"images/lottery/man1_after.png"},function(t,e,a){t.exports=a.p+"images/lottery/tool_2.png"},function(t,e,a){t.exports=a.p+"images/lottery/man2.png"},function(t,e,a){t.exports=a.p+"images/lottery/man2_after.png"},function(t,e,a){t.exports=a.p+"images/lottery/tool_3.png"},function(t,e,a){t.exports=a.p+"images/lottery/man3.png"},function(t,e,a){t.exports=a.p+"images/lottery/man3_after.png"},function(t,e,a){t.exports=a.p+"images/lottery/tool_4.png"},function(t,e,a){t.exports=a.p+"images/lottery/man4.png"},function(t,e,a){t.exports=a.p+"images/lottery/man4_after.png"},function(t,e,a){t.exports=a.p+"images/lottery/tool_5.png"},function(t,e,a){t.exports=a.p+"images/lottery/man5.png"},function(t,e,a){t.exports=a.p+"images/lottery/man5_after.png"},,,,function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(){var t=this;(0,i.default)("/lottery/game/arms").then(function(e){t.queryElement(),t.registerEvents(),t.render(t.data=e)})}a(21);var r=a(0),i=n(r),s=a(1),l=n(s),d=a(22),u=n(d);o.prototype.render=function(t){var e="";t.forEach(function(t,a){var n=l.default[t.id].arm;e+='<li data-tool="'+t.id+'">\n            <img src="'+n+'">\n            <span class="badge">'+t.chance+"</span>\n        </li>"}),this.toolNav.innerHTML=e,this.toolItems=this.toolNav.querySelectorAll("li"),this.autoActive()},o.prototype.queryElement=function(){this.toolNav=document.getElementById("tool-nav"),this.manBefore=document.querySelector(".figure.before"),this.manAfter=document.querySelector(".figure.after"),this.smoke=document.querySelector(".ani-smoke"),this.tool=document.querySelector(".ani-tool"),this.maskBg=document.querySelector(".mask-bg"),this.eleMan=document.getElementById("man-before"),this.eleManAfter=document.getElementById("man-after"),this.eleOpenBtn=document.getElementById("btn-open")},o.prototype.autoActive=function(){for(var t=!1,e=0;e<this.data.length;e++){var a=this.data[e];a.chance>0&&!t&&(void 0===this.id&&this.activeLi(this.toolItems[e]),t=!0),a.id==this.id&&this.activeLi(this.toolItems[e])}t||(alert("暂未获得抽奖机会"),this.stop=!0)},o.prototype.activeLi=function(t){this.toolItems.forEach(function(t){t.className=""}),this.id=t.getAttribute("data-tool"),t.className="active";var e=l.default[this.id];this.tool.src=e.arm,this.eleMan.src=e.before,this.eleManAfter.src=e.after},o.prototype.validateChance=function(){var t=this,e=!1;return this.data.forEach(function(a){a.id==t.id&&(e=a.chance>=1)}),e},o.prototype.deleteChance=function(){for(var t=0;t<this.data.length;t++)this.data[t].id==this.id&&(this.data[t].chance-=1);this.render(this.data)},o.prototype.registerEvents=function(){var t=this;if(this.eleOpenBtn.addEventListener("touchend",function(e){if(!t.openUrl)return!1;t.eleManAfter.src=u.default;var a=t;clearTimeout(t.timer),t.timer=setTimeout(function(){location.href=a.openUrl},800)}),this.stop)return!0;var e=this;document.addEventListener("touchend",function(a){var n=a.target;if(n.hasAttribute("data-tool")||n.parentElement.hasAttribute("data-tool")&&(n=n.parentElement)){if(a.preventDefault(),a.stopPropagation(),t.played)return!1;var o=parseInt(n.querySelector(".badge").textContent);if(!isFinite(o)||0===o)return;t.activeLi(n)}if(n.hasAttribute("data-play")){if(a.preventDefault(),a.stopPropagation(),!t.validateChance())return alert("抽奖机会已用尽!"),!1;if(t.played)return!1;t.played=!0,t.smoke.classList.add("ani-start"),t.tool.classList.add("ani-start"),setTimeout(function(){e.manBefore.classList.add("hidden"),e.manAfter.classList.remove("hidden")},400),setTimeout(function(){(0,i.default)("/lottery/game/open",{method:"post",data:{plan_id:e.id}}).then(function(t){e.maskBg.classList.remove("hidden"),e.deleteChance();var a=2,o=setInterval(function(){(a-=.5)<=0&&(clearInterval(o),e.maskBg.classList.add("hidden"),n.classList.add("hidden"),e.eleOpenBtn.classList.remove("hidden"),e.openUrl=t.url)},500)})},1e3)}},!1)},new o},function(t,e){},function(t,e,a){t.exports=a.p+"images/lottery/opened-loading.gif"}],[20]);